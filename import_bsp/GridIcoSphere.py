import bpy
from bpy_extras.io_utils import unpack_list

verts = ((0.0, -0.00024169922107830644, -0.10158729553222656),
         (0.07236003875732422, -0.05281352996826172, -0.04630899429321289),
         (-0.02763843536376953, -0.08530616760253906, -0.04630899429321289),
         (-0.08944225311279297, -0.00024169922107830644, -0.04630899429321289),
         (-0.02763843536376953, 0.0848226547241211, -0.04630899429321289),
         (0.07236003875732422, 0.05233049392700195, -0.04630899429321289),
         (0.02763843536376953, -0.08530616760253906, 0.043134212493896484),
         (-0.07236003875732422, -0.05281352996826172, 0.043134212493896484),
         (-0.07236003875732422, 0.05233049392700195, 0.043134212493896484),
         (0.02763843536376953, 0.0848226547241211, 0.043134212493896484),
         (0.08944225311279297, -0.00024169922107830644, 0.043134212493896484),
         (0.0, -0.00024169922107830644, 0.09841251373291016),
         (0.07236003875732422, 0.05233049392700195, -0.04630899429321289),
         (0.02763843536376953, -0.08530616760253906, 0.043134212493896484),
         (-0.02763843536376953, -0.08530616760253906, -0.04630899429321289),
         (-0.07236003875732422, -0.05281352996826172, 0.043134212493896484),
         (-0.08944225311279297, -0.00024169922107830644, -0.04630899429321289),
         (-0.07236003875732422, 0.05233049392700195, 0.043134212493896484),
         (-0.02763843536376953, 0.0848226547241211, -0.04630899429321289),
         (0.02763843536376953, 0.0848226547241211, 0.043134212493896484))
faces = ((0, 1, 14),
         (1, 0, 12),
         (0, 14, 16),
         (0, 16, 18),
         (0, 18, 12),
         (1, 12, 10),
         (14, 1, 13),
         (16, 14, 15),
         (18, 16, 17),
         (12, 18, 19),
         (1, 10, 6),
         (2, 6, 7),
         (3, 7, 8),
         (4, 8, 9),
         (5, 9, 10),
         (6, 10, 11),
         (7, 6, 11),
         (8, 7, 11),
         (9, 8, 11),
         (10, 9, 11))
uvs = ((0.5, 1.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (0.5, 1.0),
         (0.5, 1.0),
         (1.0, 0.0),
         (0.0, -0.0),
         (1.0, 0.0),
         (0.5, 1.0),
         (0.0, -0.0))
materials = ('Grid_00',
         'Grid_01',
         'Grid_02',
         'Grid_03',
         'Grid_04',
         'Grid_05',
         'Grid_06',
         'Grid_07',
         'Grid_08',
         'Grid_09',
         'Grid_10',
         'Grid_11',
         'Grid_12',
         'Grid_13',
         'Grid_14',
         'Grid_15',
         'Grid_16',
         'Grid_17',
         'Grid_18',
         'Grid_19')
material_ids = (15,
         16,
         19,
         18,
         17,
         14,
         12,
         10,
         8,
         6,
         13,
         11,
         9,
         7,
         5,
         3,
         2,
         1,
         0,
         4)

def createGridIcoSphere():
    me = bpy.data.meshes.new("M_GridPoint")
    me.from_pydata(verts, [], faces)

    for material in materials:
        mat = bpy.data.materials.get(material)
        if (mat == None):
            mat = bpy.data.materials.new(name=material)
        me.materials.append(mat)
    me.polygons.foreach_set("material_index", material_ids)

    me.uv_layers.new(do_init=False,name="UVMap")
    me.uv_layers["UVMap"].data.foreach_set("uv", unpack_list(uvs))
    
    ob = bpy.data.objects.new("LightGrid", me)
    bpy.context.collection.objects.link(ob)
    return ob
